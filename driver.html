<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>차량지원 시스템 - 하이콘트라스트</title>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root { --main: #002855; --sub: #0055aa; --point: #10b981; --warn: #ef4444; --bg: #f1f5f9; }
    * { box-sizing: border-box; font-family: 'Pretendard', sans-serif; -webkit-tap-highlight-color: transparent; }
    body { margin: 0; background: #000; display: flex; justify-content: center; height: 100dvh; overflow: hidden; }
    .app { width: 100%; max-width: 600px; background: var(--bg); display: flex; flex-direction: column; position: relative; }
    
    /* 상단바 */
    .header { height: 60px; background: var(--main); color: #fff; display: flex; align-items: center; justify-content: space-between; padding: 0 15px; border-bottom: 3px solid var(--sub); }
    .header .back { font-size: 24px; cursor: pointer; }
    .header .sync { font-size: 11px; background: rgba(16, 185, 129, 0.2); color: #34d399; padding: 4px 8px; border-radius: 50px; display: flex; align-items: center; gap: 5px; }
    .sync i { animation: spin 2s linear infinite; }
    @keyframes spin { 100% { transform: rotate(360deg); } }

    /* 탭 바 */
    .tabs { display: flex; background: #fff; border-bottom: 1px solid #ddd; }
    .tab { flex: 1; padding: 15px 0; text-align: center; font-weight: 900; color: #666; font-size: 14px; cursor: pointer; }
    .tab.active { color: var(--main); border-bottom: 4px solid var(--main); }

    .content { flex: 1; overflow-y: auto; padding: 12px; }

    /* 종합 일정표 디자인 (1안: 굵고 선명함) */
    .sched-table { width: 100%; border-collapse: collapse; background: #fff; table-layout: fixed; border: 2px solid #333; }
    .sched-table th, .sched-table td { border: 1px solid #333; text-align: center; height: 50px; font-size: 12px; vertical-align: middle; }
    .sched-table th { background: #e2e8f0; font-weight: 900; }
    .block-fixed { background: #3b82f6; color: #fff; font-weight: 900; font-size: 10px; } /* 월요일 고정 */
    .block-lunch { background: #94a3b8; color: #fff; font-weight: 900; }
    .block-1h { background: #10b981; color: #fff; font-weight: 800; }
    .block-2h { background: #f59e0b; color: #fff; font-weight: 800; }

    /* 퇴교 관리 (1안: 큰 버튼) */
    .card { background: #fff; border-radius: 12px; padding: 15px; border: 2px solid #002855; margin-bottom: 10px; }
    .card-title { font-size: 16px; font-weight: 900; margin-bottom: 10px; color: var(--main); }
    .notice-badge { color: #10b981; font-weight: 900; font-size: 12px; margin-bottom: 8px; display: block; }
    .btn-group { display: flex; gap: 5px; }
    .btn-time { flex: 1; height: 55px; border: 2px solid #cbd5e1; background: #fff; font-weight: 900; border-radius: 8px; font-size: 15px; }
    .btn-time.active { background: var(--main); color: #fff; border-color: var(--main); }

    /* 하단바 */
    .footer { height: 65px; background: var(--main); color: #fff; display: flex; align-items: center; justify-content: space-between; padding: 0 15px; }
    .home-btn { width: 50px; height: 50px; background: #fff; color: var(--main); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; position: absolute; bottom: 35px; left: 50%; transform: translateX(-50%); border: 4px solid var(--sub); box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
    .clock { font-size: 14px; font-weight: bold; font-family: 'Courier New', monospace; letter-spacing: 1px; }

    /* 팝업 */
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; align-items: center; justify-content: center; }
    .modal-box { background: #fff; width: 85%; border-radius: 15px; padding: 20px; text-align: center; }
  </style>
</head>
<body>
  <div class="app">
    <header class="header">
      <i class="fa-solid fa-chevron-left back" onclick="location.href='portal.html'"></i>
      <div style="font-weight: 900;">기사님 지원시스템</div>
      <div class="sync"><i class="fa-solid fa-rotate"></i> 실시간 연동중</div>
    </header>

    <div class="tabs">
      <div class="tab active" onclick="switchTab(1)">종합 일정표</div>
      <div class="tab" onclick="switchTab(2)">강사 수송</div>
      <div class="tab" onclick="switchTab(3)">교육생 퇴교</div>
    </div>

    <main class="content" id="main-content">
      <!-- 탭 1: 종합 일정표 -->
      <div id="view-1">
        <div style="text-align:center; padding:10px; font-weight:900;">2026년 1월 4주차 일정</div>
        <table class="sched-table">
          <thead><tr><th>시간</th><th>월</th><th>화</th><th>수</th><th>목</th><th>금</th></tr></thead>
          <tbody id="sched-body"></tbody>
        </table>
      </div>

      <!-- 탭 2: 강사 수송 -->
      <div id="view-2" style="display:none;">
        <div class="card" style="background: #fffbeb; border-color: #f59e0b;">
            <div style="color:#b45309; font-weight:900; font-size:13px;"><i class="fa-solid fa-circle-exclamation"></i> 행정 긴급공지</div>
            <div style="font-size:14px; margin-top:5px; font-weight:800;">금일 청주공항 공사로 인해 3번 게이트가 아닌 1번 게이트에서 대기 바랍니다.</div>
        </div>
        <div id="transport-list"></div>
      </div>

      <!-- 탭 3: 교육생 퇴교 -->
      <div id="view-3" style="display:none;">
        <div class="card" style="background: var(--main); color: #fff; text-align: center;">
            <div style="font-size: 12px; opacity: 0.8;">총 차량탑승 신청자</div>
            <div style="font-size: 32px; font-weight: 900;" id="total-req">0명</div>
        </div>
        <div id="course-list"></div>
      </div>
    </main>

    <div class="home-btn" onclick="switchTab(1)"><i class="fa-solid fa-house"></i></div>
    <footer class="footer">
      <div class="clock" id="clock">2026.01.23 00:00:00</div>
      <img src="logo.png" alt="logo" style="height:20px; filter: brightness(0) invert(1);">
    </footer>

    <!-- 수동 시간 입력 모달 -->
    <div id="manualModal" class="modal">
        <div class="modal-box">
            <h3 style="margin-top:0;">수동 시간 설정</h3>
            <input type="time" id="manual-time-input" style="width:100%; height:50px; font-size:24px; text-align:center;">
            <div style="display:flex; gap:10px; margin-top:20px;">
                <button onclick="closeModal()" style="flex:1; height:45px;">취소</button>
                <button onclick="confirmManual()" style="flex:1; height:45px; background:var(--main); color:#fff; font-weight:900;">설정완료</button>
            </div>
        </div>
    </div>
  </div>

  <script>
    let currentTab = 1;
    let selectedRid = '';

    function switchTab(n) {
      document.querySelectorAll('.tab').forEach((t, i) => t.classList.toggle('active', i+1 === n));
      document.querySelectorAll('[id^="view-"]').forEach((v, i) => v.style.display = i+1 === n ? 'block' : 'none');
      currentTab = n;
      if(n===1) renderSchedule();
      if(n===2) renderTransport();
      if(n===3) renderDeparture();
    }

    function renderSchedule() {
      const body = document.getElementById('sched-body');
      body.innerHTML = '';
      for(let h=8; h<=17; h++) {
        let row = `<tr><td>${h}:00</td>`;
        for(let d=0; d<5; d++) {
          let style = ''; let text = '';
          if(d===0 && h>=9 && h<=10) { style = 'class="block-fixed"'; text = '입교수송'; }
          else if(h===12) { style = 'class="block-lunch"'; text = '점심'; }
          else if(h===15 && d===4) { style = 'class="block-2h"'; text = '퇴교(2시간)'; }
          row += `<td ${style}>${text}</td>`;
        }
        body.innerHTML += row + `</tr>`;
      }
    }

    function renderDeparture() {
        const list = document.getElementById('course-list');
        list.innerHTML = `
            <div class="card">
                <div class="card-title">#B 관제사 양성과정</div>
                <div class="notice-badge"><i class="fa-solid fa-circle-check"></i> 15:00 운행 공지완료</div>
                <div class="btn-group">
                    <button class="btn-time" onclick="setDepTime('B', '13:00')">13:00</button>
                    <button class="btn-time active" onclick="setDepTime('B', '15:00')">15:00</button>
                    <button class="btn-time" onclick="openManual('B')">수동</button>
                </div>
            </div>
        `;
    }

    function setDepTime(rid, time) {
        if(confirm(`${time}으로 운행 시간을 변경하시겠습니까?`)) {
            alert('변경되었습니다.');
            renderDeparture();
        }
    }

    function openManual(rid) { selectedRid = rid; document.getElementById('manualModal').style.display='flex'; }
    function closeModal() { document.getElementById('manualModal').style.display='none'; }
    function confirmManual() {
        const time = document.getElementById('manual-time-input').value;
        if(time) { alert(`${time} 수동 설정 완료`); closeModal(); renderDeparture(); }
    }

    function renderTransport() {
        const list = document.getElementById('transport-list');
        list.innerHTML = `
            <div style="font-weight:900; color:var(--main); margin:15px 0 5px 5px;">1월 26일 (월)</div>
            <div class="card" style="display:flex; align-items:center; justify-content:space-between; padding:10px;">
                <div style="flex:1; border-right:1px solid #eee;">
                    <div style="font-size:20px; font-weight:900;">09:30</div>
                    <div style="font-size:12px; color:var(--sub); font-weight:800;">오송역→항기원</div>
                </div>
                <div style="flex:1.5; padding-left:15px;">
                    <div style="font-weight:900;">김철수 강사님</div>
                    <div style="display:flex; gap:5px; margin-top:8px;">
                        <button style="background:var(--point); color:#fff; border:none; padding:5px 10px; border-radius:4px; font-size:11px; font-weight:900;">승인</button>
                        <button style="background:var(--warn); color:#fff; border:none; padding:5px 10px; border-radius:4px; font-size:11px; font-weight:900;">어려움</button>
                        <button style="background:#f1f5f9; border:1px solid #ddd; padding:5px 8px; border-radius:4px;"><i class="fa-solid fa-phone"></i></button>
                    </div>
                </div>
            </div>
        `;
    }

    function updateClock() {
      const now = new Date();
      const s = now.getFullYear() + '.' + String(now.getMonth()+1).padStart(2,'0') + '.' + String(now.getDate()).padStart(2,'0') + ' ' +
                String(now.getHours()).padStart(2,'0') + ':' + String(now.getMinutes()).padStart(2,'0') + ':' + String(now.getSeconds()).padStart(2,'0');
      document.getElementById('clock').innerText = s;
    }
    setInterval(updateClock, 1000);
    switchTab(1);
  </script>
</body>
</html>