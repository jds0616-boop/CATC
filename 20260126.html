<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>25하 신입직원 인사부 면담 관리 시스템</title>
    <style>
        :root {
            --header-bg: #2c3e50;
            --active-bg: #fff176;
            --done-bg: #e0e0e0;
            --border-color: #bdc3c7;
        }

        body {
            font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
            margin: 20px;
            background-color: #f8f9fa;
        }

        h1 {
            text-align: center;
            color: var(--header-bg);
            margin-bottom: 10px;
        }

        .info-bar {
            background: #fff;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-around;
            font-weight: bold;
            font-size: 1.2em;
        }

        .status-summary span {
            margin: 0 15px;
            padding: 5px 15px;
            border-radius: 20px;
            border: 2px solid var(--header-bg);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            table-layout: fixed;
        }

        th {
            background-color: var(--header-bg);
            color: white;
            padding: 12px;
            font-size: 1.1em;
            border: 1px solid var(--border-color);
        }

        td {
            padding: 10px;
            text-align: center;
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: background 0.2s;
            position: relative;
            overflow: hidden;
            word-break: keep-all;
        }

        .no-col { width: 50px; background: #eee; font-weight: bold; cursor: default; }

        /* 상태별 스타일 */
        .status-waiting { background: white; }
        
        .status-active { 
            background-color: var(--active-bg); 
            font-weight: bold;
            box-shadow: inset 0 0 10px rgba(255,193,7,0.5);
        }
        .status-active::after {
            content: "▶ 면담중";
            display: block;
            font-size: 0.7em;
            color: #d35400;
        }

        .status-done { 
            background-color: var(--done-bg); 
            color: #888;
            text-decoration: line-through;
        }

        /* 컨트롤 안내 */
        .controls {
            text-align: right;
            margin-bottom: 10px;
            font-size: 0.9em;
            color: #666;
        }

        .btn-reset {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin-left: 10px;
        }

        /* 수정 모드용 스타일 */
        [contenteditable="true"] {
            background: #fff;
            outline: 2px solid #3498db;
        }
    </style>
</head>
<body>

    <h1>25하 신입직원 인사부 면담 현황</h1>

    <div class="info-bar">
        <div class="status-summary">
            A조(손수현): <span id="summary-A">대기</span>
            B조(이보라): <span id="summary-B">대기</span>
            C조(박윤희): <span id="summary-C">대기</span>
        </div>
    </div>

    <div class="controls">
        ※ 이름 <b>한 번 클릭</b>: 상태 변경 (대기→면담중→완료) / <b>더블 클릭</b>: 이름 수정
        <button class="btn-reset" onclick="resetAll()">전체 데이터 초기화</button>
    </div>

    <table id="interviewTable">
        <thead>
            <tr>
                <th class="no-col">순번</th>
                <th>A조 (손수현)</th>
                <th>B조 (이보라)</th>
                <th>C조 (박윤희)</th>
            </tr>
        </thead>
        <tbody id="tableBody">
            <!-- 자바스크립트로 데이터 채움 -->
        </tbody>
    </table>

    <script>
        // 초기 데이터 (사진 기준 추출)
        const initialData = [
            ["5급갑 경영 박민지", "5급갑 기계 장지호", "5급갑 건축 김영철"],
            ["5급갑 경영 조재용", "5급갑 기계 이휘", "5급갑 건축 박유진"],
            ["5급갑 경영 허재호", "5급갑 기계 이진혁", "5급갑 건축 윤인선"],
            ["5급갑 경영 정세화", "5급갑 기계 오민혁", "5급갑 건축 김주원"],
            ["5급갑 경영 이나경", "5급갑 기계 조재만", "5급갑 건축 신중현"],
            ["5급갑 관제 강민준", "5급갑 기계 우해민", "5급갑 건축 박태환"],
            ["5급갑 관제 박채은", "5급갑 기계 김광수", "5급갑 통전 윤서빈"],
            ["5급갑 관제 김운오", "5급갑 기계 이현", "5급갑 통전 이예은"],
            ["5급갑 전산 오주현", "5급갑 기계 황기은", "5급갑 통전 조정은"],
            ["5급갑 토목 최재석", "5급갑 기계 전준호", "5급갑 통전 황규빈"],
            ["5급갑 토목 이바다", "5급갑 기계 김기훈", "5급갑 통전 채윤영"],
            ["5급갑 토목 김성준", "5급갑 기계 김영욱", "5급갑 통전 박주미"],
            ["5급갑 통전 전영주", "5급갑 조경 이정헌", "공항보안(전국) 원동현"],
            ["5급갑 통전 윤동준", "5급갑 환경 박주희", "공항보안(전국) 권기환"],
            ["5급갑 통전 윤건호", "공항보안(양양) 최진경", "공항보안(김해) 오현정"],
            ["5급갑 통전 최경호", "공항보안(양양) 한호준", "공항보안(청주) 김택기"],
            ["5급갑 통전 나현성", "공항보안(광주) 김갑인", "공항보안(청주) 이상구"],
            ["5급갑 통전 염철중", "공항보안(광주) 김민경", "공항보안(청주) 서정원"],
            ["6급갑 장비 김명철", "공항보안(울산) 한아름", "공항보안(청주) 최지혜"],
            ["6급갑 장비 최호승", "공항보안(사천) 박준석", "공항보안(대구) 이원주"],
            ["EOD(무안) 변석진", "공항보안(사천) 김기웅", "공항보안(대구) 최성민"],
            ["EOD(제주) 정정헌", "공항보안(군산) 서동엽", "공항보안(무안) 정상권"],
            ["", "공항보안(군산) 박성민", "공항보안(무안) 임지희"],
            ["", "공항보안(전국 보훈) 김찬수", ""],
            ["", "공항보안(김해 보훈) 박용제", ""]
        ];

        let state = JSON.parse(localStorage.getItem('interviewStatus')) || null;

        function initTable() {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            if (!state) {
                state = initialData.map(row => row.map(name => ({ name, status: 'waiting' })));
            }

            for (let i = 0; i < 25; i++) {
                const tr = document.createElement('tr');
                
                // 순번 열
                const tdNo = document.createElement('td');
                tdNo.className = 'no-col';
                tdNo.innerText = i + 1;
                tr.appendChild(tdNo);

                // A, B, C조 열
                for (let j = 0; j < 3; j++) {
                    const td = document.createElement('td');
                    const cellData = state[i][j];
                    
                    td.innerText = cellData.name;
                    td.className = 'status-' + cellData.status;
                    
                    // 클릭 이벤트: 상태 변경
                    td.onclick = function(e) {
                        if (this.contentEditable === "true") return;
                        changeStatus(i, j, td);
                    };

                    // 더블클릭 이벤트: 이름 수정
                    td.ondblclick = function(e) {
                        e.stopPropagation();
                        this.contentEditable = "true";
                        this.focus();
                    };

                    // 수정 완료 후 저장
                    td.onblur = function() {
                        this.contentEditable = "false";
                        state[i][j].name = this.innerText;
                        saveState();
                    };

                    tr.appendChild(td);
                }
                tbody.appendChild(tr);
            }
            updateSummary();
        }

        function changeStatus(row, col, element) {
            const currentStatus = state[row][col].status;
            let nextStatus = 'waiting';

            if (currentStatus === 'waiting') nextStatus = 'active';
            else if (currentStatus === 'active') nextStatus = 'done';
            else nextStatus = 'waiting';

            state[row][col].status = nextStatus;
            element.className = 'status-' + nextStatus;
            
            saveState();
            updateSummary();
        }

        function updateSummary() {
            const groups = ['A', 'B', 'C'];
            groups.forEach((group, j) => {
                let activeName = "대기";
                for (let i = 0; i < 25; i++) {
                    if (state[i][j].status === 'active') {
                        activeName = (i + 1) + "번 " + state[i][j].name.split(' ').pop();
                        break;
                    }
                }
                document.getElementById('summary-' + group).innerText = activeName;
            });
        }

        function saveState() {
            localStorage.setItem('interviewStatus', JSON.stringify(state));
        }

        function resetAll() {
            if (confirm("정말로 모든 진행 상황을 초기화하시겠습니까? (이름 수정한 내역은 유지됩니다)")) {
                for (let i = 0; i < 25; i++) {
                    for (let j = 0; j < 3; j++) {
                        state[i][j].status = 'waiting';
                    }
                }
                saveState();
                initTable();
            }
        }

        // 초기 실행
        initTable();
    </script>
</body>
</html>